# デザインシステム - 現在の開発コンテキスト

このドキュメントでは、デザインシステム開発の現在の焦点、最近の活動、現在の課題などを記録します。対話的アプローチで開発を進めていきます。

## 最新のアクション

**プライマリカラーの調整**

Storybook での確認後、プライマリカラーが強すぎる（きつすぎる）ため、同じカラーのベースを維持しつつより優しい色合いに調整しました：

1. プライマリカラーの変更:

   - 元の色: `#f4b321` → 新しい色: `#f8c552` (より明るく、彩度を少し下げた)
   - プライマリライト: `#ffca58` → `#fad87b` (より明るく柔らかい印象に)
   - プライマリダーク: `#d99b0d` → `#e0aa32` (暗い色も少し明るく調整)

2. 透明度バリエーションの調整:

   - `--color-primary-10`: `rgba(244, 179, 33, 0.1)` → `rgba(248, 197, 82, 0.08)`
   - `--color-primary-20`: `rgba(244, 179, 33, 0.2)` → `rgba(248, 197, 82, 0.15)`
   - `--color-primary-50`: `rgba(244, 179, 33, 0.5)` → `rgba(248, 197, 82, 0.4)`

3. global.css のユーティリティクラスも更新し、Storybook で視覚的に一貫性のある表示を確保

## 現在のフォーカス

**レイアウトコンポーネントの Storybook 実装の完了とカラー調整**

レイアウトコンポーネント（Header、Footer、Sidebar、Layout、ChatLayout）の Storybook 可視化が完了し、視覚的な改善のためにプライマリカラーを調整しました。各コンポーネントに対して複数のストーリーバリエーションを作成し、以下の要素を考慮しています：

- 様々な状態とプロパティの組み合わせ
- インタラクティブな要素（設定ボタンのクリックなど）
- レスポンシブ対応（モバイル表示など）
- フルスクリーンレイアウトでの表示
- 優しくなったカラースキームの適用

## 主要なタスク

- [x] Header コンポーネントの.stories.tsx ファイル作成
- [x] Footer コンポーネントの.stories.tsx ファイル作成
- [x] Sidebar コンポーネントの.stories.tsx ファイル作成
- [x] Layout コンポーネントの.stories.tsx ファイル作成
- [x] ChatLayout コンポーネントの.stories.tsx ファイル作成
- [x] プライマリカラーの調整
- [ ] Storybook 実行とレイアウト表示の実機検証
- [ ] ユーザーフィードバックの収集

## 次のステップ

1. **Storybook 実行と視覚的検証**

   - 実際に Storybook を実行して各レイアウトコンポーネントの表示を確認
   - 新しいカラースキームでの見栄えを確認
   - レスポンシブ対応の確認（特にモバイルとデスクトップ）
   - インタラクションの動作確認

2. **専用コンポーネントの TypeScript 移行の完了**

   - 残りの専用コンポーネントの TypeScript 化を優先的に進める
   - 型定義の最適化とエラー修正

3. **Storybook ドキュメントの充実**
   - コンポーネントの使用例と使用方法の追加
   - アクセシビリティ情報の追加

## 注意点と課題

- 調整したプライマリカラーが様々なコンポーネントで適切に表示されるか検証が必要
- 新しいカラースキームがアクセシビリティ要件（コントラスト比など）を満たしているか確認
- レイアウトコンポーネントは様々な状態や組み合わせがあるため、Storybook での表示検証が重要
- 各レイアウトコンポーネントのレスポンシブ対応が適切かを確認する必要がある
- モバイル表示とデスクトップ表示の両方で一貫したユーザー体験を提供できているか確認が必要

## 開発状況

現在、デザインシステムの実装フェーズは完了し、Storybook による可視化と検証フェーズに移行しています。レイアウトコンポーネントの Storybook 実装が完了し、プライマリカラーの視覚的改善も行ったことで、ユーザーに対してより洗練されたコンポーネントの様々な状態とバリエーションを示すことができるようになりました。

**更新日**: 2023-04-15

## 現在の焦点

- **レイアウトコンポーネントの Storybook 可視化**: 作成したレイアウトコンポーネントを Storybook 上で可視化し、UI の検討と検証を行う
- **TypeScript への移行の完了**: 残りのコンポーネントを TypeScript に変換し、型安全性を向上させる
- **フィーチャー依存コンポーネントの最適化**: rag-chat 機能に特化したコンポーネントの構造と依存関係の管理
- **Storybook 環境の改善**: コンポーネントカテゴリの整理とドキュメント化の強化
- **コンポーネントテストの導入**: テスト戦略の策定と基本的なテストケースの実装
- **ユーザーエクスペリエンスの向上**: 時間表示などの細部の改善による UX の最適化

## 最近の活動

1. **コアコンポーネントの実装**

   - 基本コンポーネント（Button, Card, Input, ThemeToggle）の実装
   - RAG チャット機能コンポーネントの実装と最適化
   - コンポーネントのドキュメント化

2. **ディレクトリ構造の最適化**

   - コアコンポーネント (`app/components/`) と機能特化コンポーネント (`app/features/rag-chat/components/`) の明確な分離
   - Chat 関連コンポーネント (ChatInterface, ChatHistory, ChatInput, ChatBubble) を機能特化ディレクトリに移動
   - コンポーネント間の依存関係の修正と最適化

3. **TypeScript への移行**

   - Button と Card コンポーネントを最初に TypeScript で実装
   - ThemeToggle コンポーネントを JSX から TSX に変換
   - Input コンポーネントを JSX から TSX に変換
   - 適切な型定義とインターフェースの追加

4. **Storybook の改善**

   - ストーリーファイルをコンポーネントディレクトリ内に移動 (コンポーネントと一緒に管理)
   - コンポーネントカテゴリの整理 (Core Components と Features/RAG Chat に分類)
   - Storybook 設定の更新 (stories パスの変更)
   - ストーリーサンプルのタイムスタンプ形式を統一 (ISO 形式)

5. **UI/UX の改善**

   - ChatBubble コンポーネントの時間表示を日本時間形式（午前/午後）に変更
   - メッセージバブルの横に時間を表示するレイアウトに変更
   - タイムスタンプの処理と表示を一貫性のある方法に最適化
   - より見やすいメッセージとタイムスタンプの視覚的分離

6. **レイアウトコンポーネントの実装**
   - Header, Footer, Sidebar, Layout, ChatLayout コンポーネントの実装
   - ChatGPT/Claude 風のモダンなチャット UI レイアウトの実装
   - ページへのレイアウト適用と動作確認

## 未着手の作業

1. **レイアウトコンポーネントの Storybook 可視化**
   - 各レイアウトコンポーネントの Stories ファイル作成
   - インタラクティブな例の作成とドキュメント化
   - 様々な状態や設定でのレイアウト表示の検証
   - レスポンシブ動作の確認とビューポートツールでの検証

## 現在の課題

1. **レイアウトコンポーネントの Storybook 可視化の未着手**

   - レイアウトコンポーネントの Stories ファイルが未作成
   - レイアウトコンポーネントのインタラクティブな例とドキュメントの不足
   - 複雑なレイアウト構造の Storybook 上での効果的な表示方法の検討

2. **TypeScript 移行の課題**

   - 機能特化コンポーネント (ChatBubble, ChatInput, ChatHistory, ChatInterface) の TypeScript 化
   - 複雑なコンポーネントの型定義の最適化
   - 型エラーの解決と型安全性の確保

3. **Storybook 関連の課題**

   - コンポーネントドキュメントの拡充
   - アクセシビリティチェックの導入
   - インタラクティブな例の改善

4. **テスト戦略**

   - 効果的なテスト戦略の策定
   - ユニットテストの導入
   - ビジュアルリグレッションテストの検討

5. **パフォーマンス最適化**
   - バンドルサイズの分析と最適化
   - レンダリングパフォーマンスの改善策の検討

## 現在のプライオリティ

1. レイアウトコンポーネントの Storybook 可視化と検証
2. RAG チャット関連コンポーネントの TypeScript への移行
3. Storybook でのコンポーネントドキュメントの充実
4. テスト戦略の策定と基本的なテストの実装
5. レスポンシブデザインの検証と改善
6. 時間やデータ表示に関するグローバル関数の整理

## 今後の方向性

- レイアウトコンポーネントの Storybook 可視化と改善
- 全コンポーネントの TypeScript 化完了
- コンポーネントライブラリとしての公開準備
- デザインシステムドキュメントの充実
- アクセシビリティ対応の強化
- 日付・時間表示ユーティリティの分離と共通化

## 記録日時

2023 年 3 月 24 日

## 重要なコンテキスト情報

- デザインシステムは React コンポーネントをベースに構築予定
- モバイルファーストのレスポンシブデザインを採用
- ダークモード対応を初期段階から考慮
- ユーザー対話型の開発プロセスを採用
- 日本語環境での使用を前提とした日時表示の最適化
- Storybook を活用した視覚的な検証と改善のフロー重視

## 主要な質問トピック

ユーザーとの対話を通じて以下の情報を収集する必要があります：

1. **ブランドと視覚的アイデンティティ**

   - 企業/製品のブランドの核となる価値は何か
   - 視覚的に表現したいブランドの印象や感情は何か
   - 競合他社との差別化要素は何か

2. **ユーザーとコンテキスト**

   - 主要なユーザーペルソナは誰か
   - ユーザーの主な使用環境や状況は何か
   - アクセシビリティに関する特別な要件はあるか

3. **機能と優先順位**

   - 最も頻繁に使用される機能や要素は何か
   - ユーザーが最も価値を感じる機能は何か
   - 初期開発で優先すべきコンポーネントは何か

4. **レイアウトパターン**

   - アプリケーションにはどのようなレイアウトが必要か
   - ヘッダー、フッター、サイドバーは必要か
   - ページ間で共通のレイアウト要素は何か
   - レスポンシブ対応でのレイアウトの変化はどうあるべきか

5. **技術的考慮事項**
   - サポートが必要なデバイスとブラウザは何か
   - パフォーマンスに関する要件や制約はあるか
   - 既存のシステムやツールとの統合要件は何か

## 次のアクション

- [x] レイアウトパターンの特定と要件収集
- [x] ヘッダー、フッター、サイドバーの必要性の検討
- [x] グリッドシステムの設計
- [x] コアコンポーネントの実装
- [x] デザイン原則の策定と検証
- [x] コンポーネント命名規則の確立
- [x] 機能特化コンポーネントのディレクトリ再編成
- [x] UI/UX の詳細な改善（時間表示など）
- [x] レイアウトコンポーネントの実装
- [ ] レイアウトコンポーネントの Storybook 可視化
- [ ] Storybook でのインタラクティブな例の作成
- [ ] レイアウトコンポーネントの各種状態の検証
- [ ] 日付・時間表示ユーティリティの共通化
- [ ] 機能特化コンポーネントの TypeScript 化
- [ ] テスト戦略の詳細化と実装

## 開発ステータス

現在は **レイアウトコンポーネント実装フェーズを完了** し、**レイアウトコンポーネントの Storybook 可視化と検証フェーズ** に移行します。並行して TypeScript 移行の完了と UI/UX の詳細な改善を進めています。

## 重要なリソース

- [デザインシステムフロー](../flow/designSystemFlow.md)
- [デザイン原則](../rules/designPrinciples.md)
- [コンポーネントリスト](../components/componentList.md)
